#!/bin/bash

echo "Starting script..."

# List of packages to uninstall
packages=(
    "fedora-media-writer"
    "gnome-boxes"
    "gnome-contacts"
    "gnome-maps"
    "gnome-tour"
    "gnome-weather"
    "rhythmbox"
)

# Uninstall packages
echo "Uninstalling specified packages..."
for package in "${packages[@]}"
do
    echo "Removing $package..."
    sudo dnf remove -y "$package"
done
echo "Uninstallation complete."

# Update the system
echo "Updating the system..."
sudo dnf update -y

# Install Flatpak if not already installed
if ! command -v flatpak &> /dev/null
then
    echo "Flatpak not found. Installing Flatpak..."
    sudo dnf install -y flatpak
    echo "Adding Flathub repository..."
    flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo
else
    echo "Flatpak is already installed."
fi

# DNF applications to install
dnf_apps=(
    "alacritty"
    "curl"
    "fzf"
    "git"
    "ulauncher"
    "zsh"
)

# Flatpak applications to install
flatpak_apps=(
    "com.jetbrains.IntelliJ-IDEA-Ultimate"
    "com.slack.Slack"
    "com.spotify.Client"
)

# Install DNF applications
echo "Installing DNF applications..."
for app in "${dnf_apps[@]}"
do
    echo "Installing $app via DNF..."
    sudo dnf install -y "$app"
done

# Install Flatpak applications
echo "Installing Flatpak applications..."
for app in "${flatpak_apps[@]}"
do
    echo "Installing $app via Flatpak..."
    flatpak install -y flathub "$app"
done

# Clean up any unused dependencies
echo "Cleaning up unused dependencies..."
sudo dnf autoremove -y

echo "Script completed."